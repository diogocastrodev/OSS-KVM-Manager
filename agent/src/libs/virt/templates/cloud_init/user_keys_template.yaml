#cloud-config
hostname: {hostname}
manage_etc_hosts: true

users:
  - name: {username}
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: [sudo, adm]
    shell: /bin/bash
    ssh_authorized_keys:
      - {ssh_public_key}

ssh_pwauth: false
disable_root: true

# Grow filesystem after qemu-img resize
growpart:
  mode: auto
  devices: ["/"]
resize_rootfs: true

power_state:
  mode: poweroff
  message: "Cloud-init finished; powering off"
  timeout: 30
  condition: true
